<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Maze</title><style>body{margin:0;padding:0;background-color:tan;text-align:center}.dimension, #generate{font-family:monospace;font-size:14px}.dimension{width:72px}#generate{margin:14px}.maze{display:table;margin:auto}.maze .row{display:table-row}.maze .cell{display:table-cell;width:30px;height:30px}.maze .cell.wall{background-color:#000}.maze .cell.open{cursor:pointer}.maze .cell.open:not(.player):hover{background-color:#f00;opacity:0.1;border-radius:50%}.maze .cell.player{background-color:#f00;border-radius:50%}#win{background-color:rgba(255,255,255,0.97);border-radius:8px;font-size:48px;left:50%;padding:12px 24px;position:fixed;top:50%;transform:translate(-50%, -50%)}.hidden{display:none}</style></head><body><input class="dimension" type="text" placeholder="height"> &times; <input class="dimension" type="text" placeholder="width"><button id="generate">Regenerate Maze</button><div class="maze"></div><div id="win" class="hidden">Winner Is You.</div><script>'use strict';var _slicedToArray=function(){function a(b,c){var d=[],e=!0,f=!1,g=void 0;try{for(var j,h=b[Symbol.iterator]();!(e=(j=h.next()).done)&&(d.push(j.value),!(c&&d.length===c));e=!0);}catch(k){f=!0,g=k}finally{try{!e&&h['return']&&h['return']()}finally{if(f)throw g}}return d}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c)}}(),_createClass=function(){function a(b,c){for(var e,d=0;d<c.length;d++)e=c[d],e.enumerable=e.enumerable||!1,e.configurable=!0,'value'in e&&(e.writable=!0),Object.defineProperty(b,e.key,e)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(){'use strict';function a(E){return 1<E?Math.floor(E*Math.random()):0}function b(E){h=E.asGrid(),j=h.length-1,k=h[0].length-1;var F=a(4),G=2*a(j/2)+1,H=2*a(k/2)+1;F===p.NORTH?h[0][H]=t.OPEN:F===p.SOUTH?h[j][H]=t.OPEN:F===p.EAST?h[G][k]=t.OPEN:F===p.DENIS?h[G][0]=t.OPEN:void 0;for(var K,I=c('maze'),J=0;J<=j;J++){K=c('row','y'+J);for(var M,L=0;L<=k;L++)M=c('cell','x'+L,h[J][L]===t.WALL?'wall':'open'),K.appendChild(M);I.appendChild(K)}q.MAZE.parentNode.replaceChild(I,q.MAZE),q.MAZE=I}function c(){for(var H=document.createElement('div'),F=arguments.length,E=Array(F),G=0;G<F;G++)E[G]=arguments[G];var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var J,K,I=E[Symbol.iterator]();!(_iteratorNormalCompletion=(J=I.next()).done);_iteratorNormalCompletion=!0)K=J.value,H.classList.add(K)}catch(L){_didIteratorError=!0,_iteratorError=L}finally{try{!_iteratorNormalCompletion&&I.return&&I.return()}finally{if(_didIteratorError)throw _iteratorError}}return H}function d(){var E=parseInt(q.DIMENSIONS[0].value,10),F=parseInt(q.DIMENSIONS[1].value,10);if(isNaN(E)||isNaN(F)||1>E||1>F){var G=document.documentElement;E=Math.floor((G.clientHeight-s.BUTTON)/(2*s.CELL))-1,F=Math.floor(G.clientWidth/(2*s.CELL))-1,q.DIMENSIONS[0].value=E,q.DIMENSIONS[1].value=F}var H=new v(E,F);b(H),e()}function e(){var E=(j>>2<<1)+1,F=(k>>2<<1)+1,G=q.MAZE.querySelector('.y'+E+' .x'+F);G.classList.add('player'),l={cell:G,y:E,x:F},q.WIN.classList.add('hidden'),document.addEventListener('keydown',f)}function f(_ref3){var E=_ref3.keyCode,_ref4=[l.y,l.x],F=_ref4[0],G=_ref4[1];switch(E){case r.UP:F--;break;case r.DOWN:F++;break;case r.LEFT:G--;break;case r.RIGHT:G++;break;default:return;}if(void 0!==h[F]&&void 0!==h[F][G]){if(h[F][G]===t.WALL)switch(E){case r.UP:case r.DOWN:if(h[F][G+1]===t.OPEN&&h[F][G-1]===t.WALL)G++;else if(h[F][G-1]===t.OPEN&&h[F][G+1]===t.WALL)G--;else return;break;case r.LEFT:case r.RIGHT:if(h[F+1][G]===t.OPEN&&h[F-1][G]===t.WALL)F++;else if(h[F-1][G]===t.OPEN&&h[F+1][G]===t.WALL)F--;else return;}if(g(F,G),setTimeout(function(){m===E&&f({keyCode:E})},75),!m){m=E,document.removeEventListener('keydown',f);var H=function(){m=null,document.removeEventListener('keyup',H),document.addEventListener('keydown',f)};document.addEventListener('keyup',H)}}}function g(E,F){var G=q.MAZE.querySelector('.y'+E+' .x'+F);requestAnimationFrame(function(){l.cell.classList.remove('player'),l={cell:G,y:E,x:F},l.cell.classList.add('player'),(0==E||E==j||0==F||F==k)&&(document.removeEventListener('keydown',f),m=null,q.WIN.classList.remove('hidden'))})}var h,j,k,l,m,o=Infinity,p={NORTH:0,SOUTH:1,EAST:2,DENIS:3},q={DIMENSIONS:document.querySelectorAll('.dimension'),GENERATE_BUTTON:document.getElementById('generate'),MAZE:document.querySelector('.maze'),WIN:document.getElementById('win')},r={LEFT:37,UP:38,RIGHT:39,DOWN:40},s={BUTTON:52,CELL:30},t={WALL:!1,OPEN:!0},u=function E(){_classCallCheck(this,E),this.down=t.WALL,this.right=t.WALL},v=function(){function E(F,G){_classCallCheck(this,E),this.height=F,this.width=G,this.cells_=Array(this.height);for(var H=0;H<this.height;H++)this.cells_[H]=Array(this.width);this.randomize_()}return _createClass(E,[{key:'randomize_',value:function randomize_(){var F=[a(this.height),a(this.width)];this.cells_[F[0]][F[1]]=new u;for(var G=[F];0<G.length;){var H=G[G.length-1],I=this.getUndiscoveredNeighbors_(H);if(0===I.length)G.pop();else{var L=I[a(I.length)],M=this.cells_[L[0]][L[1]]=new u,J=L[0]-H[0],K=L[1]-H[1];1===J?this.cells_[H[0]][H[1]].down=t.OPEN:-1===J?M.down=t.OPEN:1===K?this.cells_[H[0]][H[1]].right=t.OPEN:-1===K&&(M.right=t.OPEN),G.push(L)}}}},{key:'getUndiscoveredNeighbors_',value:function getUndiscoveredNeighbors_(_ref){var _ref2=_slicedToArray(_ref,2),F=_ref2[0],G=_ref2[1],H=[];return 0<F&&!this.cells_[F-1][G]&&H.push([F-1,G]),F<this.height-1&&!this.cells_[F+1][G]&&H.push([F+1,G]),0<G&&!this.cells_[F][G-1]&&H.push([F,G-1]),G<this.width-1&&!this.cells_[F][G+1]&&H.push([F,G+1]),H}},{key:'asGrid',value:function asGrid(){var F=(this.cells_.length<<1)+1,G=(this.cells_[0].length<<1)+1,H=Array(F);H[0]=Array(G).fill(t.WALL);for(var I=1;I<F;I++)if(H[I]=Array(G),H[I][0]=t.WALL,1&I)for(var J=1;J<G;J++)H[I][J]=1&J?t.OPEN:this.cells_[I-1>>1][(J>>1)-1].right;else for(var K=1;K<G;K++)H[I][K]=1&K?this.cells_[(I>>1)-1][K-1>>1].down:t.WALL;return H}}]),E}(),w=function(){function E(){_classCallCheck(this,E),this.clear()}return _createClass(E,[{key:'clear',value:function clear(){this.head_=null,this.tail_=null}},{key:'push',value:function push(F){var G={value:F,next:null};null==this.tail_?this.head_=this.tail_=G:(this.tail_.next=G,this.tail_=G)}},{key:'pop',value:function pop(){if(null!=this.head_){var F=this.head_.value;return this.head_==this.tail_?this.clear():this.head_=this.head_.next,F}}},{key:'isEmpty',value:function isEmpty(){return null==this.tail_}}]),E}(),z=function(){function E(F,G,H){_classCallCheck(this,E),this.y=F,this.x=G,this.prev=H}return _createClass(E,[{key:'toString',value:function toString(){return this.y+','+this.x}},{key:'toCoords',value:function toCoords(){return[this.y,this.x]}}]),E}(),A=[];setInterval(function(){if(0<A.length){var _moveStack$pop=A.pop(),_moveStack$pop2=_slicedToArray(_moveStack$pop,2),E=_moveStack$pop2[0],F=_moveStack$pop2[1];g(E,F)}},50),document.body.addEventListener('click',function(_ref5){var E=_ref5.target;if(E.classList.contains('open')){var F=E.parentNode.className.match(/y(\d+)/)[1]+','+E.className.match(/x(\d+)/)[1],G=new Set,H=new w,I=function(K,L,M){if(h[K][L]==t.OPEN&&!G.has(K+','+L)){var N=new z(K,L,M);G.add(N.toString()),H.push(N)}};I(l.y,l.x,null);for(var J;!H.isEmpty()&&G.size<o&&(J=H.pop(),J.toString()!=F);){var _current=J,K=_current.y,L=_current.x;K<j&&I(K+1,L,J),0<K&&I(K-1,L,J),L<k&&I(K,L+1,J),0<L&&I(K,L-1,J)}if(G.size<o)for(A=[];null!=J.prev;J=J.prev)A.push(J.toCoords())}}),q.GENERATE_BUTTON.addEventListener('click',d),d()})();</script></body></html>
